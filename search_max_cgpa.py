import docx

roll_numbers = ['2110080001', '2110080002', '2110080003', '2110080004', '2110080005', '2110080006', '2110080007', '2110080008', '2110080009', '2110080010', '2110080011', '2110080013', '2110080014', '2110080015', '2110080016', '2110080017', '2110080018', '2110080019', '2110080020', '2110080021', '2110080022', '2110080023', '2110080024', '2110080025', '2110080026', '2110080027', '2110080028', '2110080029', '2110080030', '2110080031', '2110080032', '2110080033', '2110080034', '2110080035', '2110080036', '2110080037', '2110080038', '2110080039', '2110080040', '2110080041', '2110080042', '2110080043', '2110080044', '2110080045', '2110080046', '2110080047', '2110080048', '2110080049', '2110080050', '2110080051', '2110080053', '2110080054', '2110080055', '2110080056', '2110080057', '2110080058', '2110080059', '2110080060', '2110080061', '2110080062', '2110080063', '2110080064', '2110080065', '2110080067', '2110080068', '2110080069', '2110080071']

max_cgpa = 0.0
names = []
stream = '\\CGPA_docs\\'
extension = '.docx'

for roll_number in roll_numbers:

    document = docx.Document(stream + roll_number + extension)
    cgpa = float(document.paragraphs[3].text.split(' ')[1])
    name = document.paragraphs[1].text[6:-1]

    if cgpa > max_cgpa:
        max_cgpa = cgpa
        names = [name]

    elif cgpa == max_cgpa:
        names.append(name)
        
if len(names) == 1:
    print('\n' + names[0] + ' has the highest CGPA of ' + str(max_cgpa) + '\n')
else:
    print('\n' + ', '.join(names) + ' tie for the highest CGPA of ' + str(max_cgpa) + '\n')
